# 🚨 必读：AI助手行为约定

**这个文件必须在每个新对话开始时立即读取！**

---

## 协议约定

### 📋 强制规则（NO EXCEPTIONS）

**每次修改代码后，MUST 更新 .ai 文件夹**

```
代码修改完  →  更新 .ai/ISSUES_AND_SOLUTIONS.md
         →  更新 .ai/IMPORTANT_NOTES.md（如有新发现）
            →  git commit 包含 .ai/ 的更改
```

**没有例外！即使修改很小，也要更新记录。**

---

## 强制步骤

### 🟢 新对话开始时（MUST DO）

1. **立即读取本文件** (你正在做的事)
2. **读取 `.ai/PROJECT_OVERVIEW.md`** - 了解项目结构
3. **读取 `.ai/IMPORTANT_NOTES.md`** - 了解关键信息和注意事项
4. **读取 `.ai/ISSUES_AND_SOLUTIONS.md`** - 了解已知问题和解决方案
5. **准备好后开始工作**

### 🔧 修改代码时（MUST DO）

- [ ] 修改代码
- [ ] 立即更新 `.ai/ISSUES_AND_SOLUTIONS.md` 记录问题/解决方案
- [ ] 如有新发现，更新 `.ai/IMPORTANT_NOTES.md`
- [ ] 提交时 **必须包含** `.ai/` 文件的更改

### ✅ 结束对话前（MUST DO）

- [ ] 验证所有代码修改都已提交
- [ ] 验证 `.ai/` 文件已更新
- [ ] 验证提交消息包含 `.ai/` 相关的更改

---

## 项目关键信息速查

| 项目 | 信息 |
|------|------|
| **项目名** | Sonic (fork) |
| **Module路径** | `github.com/aaro-n/sonic` |
| **当前版本** | v1.1.5 |
| **主分支** | master |
| **仓库URL** | https://github.com/aaro-n/sonic/sonic |

---

## 常见错误预防

### ❌ 不要做这些事情：

1. **修改代码但不更新 .ai/** - 违反强制规则
2. **提交代码但不包含 .ai/ 的更改** - 不完整的提交
3. **删除或覆盖 .ai/ 中的内容** - 丢失知识库
4. **在 .ai/ 中记录错误信息** - 必须记录正确的解决方案

### ✅ 应该做的事情：

1. **每次修改都更新 .ai/** - 保持知识库最新
2. **详细记录问题和解决方案** - 便于后续参考
3. **定期检查 .ai/ 是否过期** - 更新时间戳
4. **在提交消息中提及 .ai/ 的更改** - 保持透明

---

## 文件职责分工

| 文件 | 职责 | 何时更新 |
|------|------|---------|
| `README.md` | .ai文件夹的总体说明 | 极少更新 |
| `PROJECT_OVERVIEW.md` | 项目结构、架构、特性 | 项目有重大变化时 |
| `IMPORTANT_NOTES.md` | 关键代码位置、常用命令、常见错误 | 发现新错误或新命令时 |
| `ISSUES_AND_SOLUTIONS.md` | **所有遇到的问题和解决方案** | **每次修复问题后** |

---

## 快速检查清单

**新对话开始时：**
- [ ] 读取了 .ai/MUST_READ_FIRST.md（本文件）
- [ ] 读取了 .ai/PROJECT_OVERVIEW.md
- [ ] 读取了 .ai/IMPORTANT_NOTES.md
- [ ] 读取了 .ai/ISSUES_AND_SOLUTIONS.md

**修改代码时：**
- [ ] 代码修改已完成
- [ ] 更新了 .ai/ISSUES_AND_SOLUTIONS.md
- [ ] 更新了 .ai/IMPORTANT_NOTES.md（如需）
- [ ] 已经过git add和git commit

**提交时：**
- [ ] 提交消息清晰描述了变化
- [ ] 提交包含了 .ai/ 文件的更改
- [ ] 没有遗漏任何代码修改

---

## 强制执行机制

虽然目前依赖于AI助手的自觉遵守，但建议实施以下机制：

1. **Pre-commit Hook** - 防止提交不完整的修改
2. **CI/CD检查** - 验证每个commit都更新了 .ai/
3. **定期审计** - 检查提交历史是否遵守约定

---

## 联系和反馈

如果遇到以下情况，需要更新本文件：
- 发现新的强制规则
- 工作流程有变化
- 有更好的实施方案

---

**最后更新：2026-02-20 19:30**

**重要：每个新对话开始前都要阅读本文件！** 🚨
